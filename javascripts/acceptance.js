var Acceptance=(function(){var k=function(a){a.apply(q)};var h={};var j=function(a){return h[a]||(h[a]=new y(a))};Object.extend(k,{reattach:function(){var a=0;for(var b in h){if(h[b]._5())++a}return a}});var A=/^\-?(0|[1-9]\d*)(\.\d+)?(e[\+\-]?\d+)?$/i;var n=/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[A-Z]{2}|com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum)\b$/i;var p=function(a){return a?false:(String(a).strip()=='')};var l=function(a){return A.test(String(a))};var C=function(a){return this.EMAIL_FORMAT.test(String(a))};var t=function(a){return!p(a)||['is required']};var s=function(b){var c=$(b).ancestors().find(function(a){return a.match('label')});if(c)return c;var d=b.id;if(!d)return null;return $$('label[for='+d+']')[0]||null};var B=function(a){return $(a).serialize()};var r=function(a){return $(a).serialize(true)};var q={form:function(a){return j(a)._7||null},when:function(a){return j(a)._z||null},before:function(a){return j(a)._r||null},EMAIL_FORMAT:n};var i=Class.create({initialize:function(a){this._0=a},requires:function(a,b){var c=this._0._n(a);if(b)this._0._8[a]=b;return c._7},validates:function(a){this._0._j.push(a);return this},submitsUsingAjax:function(){this._0._9=true;return this}});i.prototype.expects=i.prototype.requires;FormDSLMethods=['requires','expects','validates','submitsUsingAjax'];var m=Class.create({initialize:function(a){this._1=a},toBeChecked:function(c){var d=this._1;this._1._2(function(a){var b=d._o[0];return(a==b.value&&b.checked)||[c||'must be checked']});return this},toBeNumeric:function(b){this._1._2(function(a){return l(a)||[b||'must be a number']});return this},toBeOneOf:function(b,c){this._1._2(function(a){return b.include(a)||[c||'is not valid']});return this},toConfirm:function(c,d){this._1._2(function(a,b){return a==b.get(c)||[d||'must be confirmed',c]});return this},toHaveLength:function(b,c){var d=b.minimum,e=b.maximum;this._1._2(function(a){return(typeof b=='number'&&a.length!=b&&[c||'must contain exactly '+b+' characters'])||(d!==undefined&&a.length<d&&[c||'must contain at least '+d+' characters'])||(e!==undefined&&a.length>e&&[c||'must contain no more than '+e+' characters'])||true});return this},toHaveValue:function(b,c){var d=b.minimum,e=b.maximum;this._1._2(function(a){if(!l(a))return[c||'must be a number'];a=Number(a);return(d!==undefined&&a<d&&[c||'must be at least '+d])||(e!==undefined&&a>e&&[c||'must not be greater than '+e])||true});return this},toMatch:function(b,c){this._1._2(function(a){return b.test(a)||[c||'is not valid']});return this}});FormDSLMethods.each(function(b){m.prototype[b]=function(){var a=this._1._0._7;return a[b].apply(a,arguments)}});var v=Class.create({initialize:function(a){this._0=a},isValidated:function(b,c){this._0.subscribe(function(a){b.call(c||null,a._4._s())})},responseArrives:function(a,b){if(!this._0._9)return;if(b)a=a.bind(b);this._0._e=a}});var w=Class.create({initialize:function(a){this._0=a},isValidated:function(a){this._0._f.push(a)}});var y=Class.create({initialize:function(a){this._g=[];this._b=this._b.bindAsEventListener(this);this._A=a;this._5();this._3={};this._j=[];this._f=[];this._7=new i(this);this._z=new v(this);this._r=new w(this)},subscribe:function(a,b){this._g.push({_m:a,_p:b||null})},notifyObservers:function(){var b=$A(arguments);this._g.each(function(a){a._m.apply(a._p,b)})},_5:function(){if(this._k())return false;this._6={};this._i={};this._8={};this._0=$(this._A);if(!this._k())return false;this._0.observe('submit',this._b);for(var a in this._3)this._3[a]._5();return true},_k:function(){return this._0&&this._0.match('body form')},_n:function(a){return this._3[a]||(this._3[a]=new x(this,a))},_b:function(a){var b=this._l();if(this._9||!b)Event.stop(a);if(!this._9||!b)return;var c=this._0;new Ajax.Request(c.action,{method:c.method||'post',parameters:this._q,onSuccess:this._e})},_e:function(a){},_a:function(b){if(this._6[b])return this._6[b];var c=['input','textarea','select'].map(function(a){return a+(b?'[name='+b+']':'')}).join(', ');return this._6[b]=this._0.descendants().findAll(function(a){return a.match(c)})},_h:function(a){if(a.name)a=a.name;return this._i[a]||(this._i[a]=s(this._a(a)[0]))},_t:function(d){if(this._8[d])return this._8[d];var e=this._h(d);var f=((e||{}).innerHTML||d).stripTags();f=f.replace(/(\w)[_-](\w)/g,'$1 $2').replace(/([a-z])([A-Z])/g,function(a,b,c){return b+' '+c.toLowerCase()});return this._8[d]=f.charAt(0).toUpperCase()+f.substring(1)},_u:function(){return this._q=r(this._0)},_v:function(){this._4=new z(this);var b=this._u(),c,d;this._f.each(function(a){a(b)});b=new u(b);for(c in this._3)this._3[c]._w(b.get(c),b);this._j.each(function(a){a(b,this._4)},this);var e=this._4._x();for(c in this._6)[this._a(c),[this._h(c)]].invoke('each',function(a){a[e.include(c)?'addClassName':'removeClassName']('invalid')});this.notifyObservers(this)},_l:function(){this._v();return this._4._y()==0}});var x=Class.create({initialize:function(a,b){this._0=a;this._c=b;this._d=[];this._7=new m(this);this._5()},_5:function(){this._o=this._0._a(this._c)},_2:function(a){this._d.push(a)},_w:function(e,f){var g=[],o=this._d.length?this._d:[t],e=e||'';o.each(function(a){var b=a(e,f),c,d;if(b!==true){c=b[0];d=b[1]||this._c;this._0._4.register(this._c);this._0._4.add(d,c)}},this);return g.length?g:true}});var u=Class.create({initialize:function(b){this.get=function(a){return b[a]===undefined?null:b[a]}}});var z=Class.create({initialize:function(e){var f={},g=[];Object.extend(this,{register:function(a){f[a]=f[a]||[]},add:function(a,b){this.register(a);f[a].push(b)},addToBase:function(a){g.push(a)},_y:function(){var a=g.length;for(var b in f)a+=f[b].length;return a},_s:function(){var b,c=g.map(function(a){return{field:null,message:a}});for(var d in f){b=e._t(d);f[d].each(function(a){c.push({field:d,message:b+' '+a})})}return c},_x:function(){var a=[];for(var b in f)a.push(b);return a}})}});return k})();